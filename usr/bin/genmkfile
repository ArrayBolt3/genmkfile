#!/bin/bash

## Copyright (C) 2020 - 2020 ENCRYPTED SUPPORT LP <adrelanos@riseup.net>
## See the file COPYING for copying conditions.

MYDIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

pushd "$MYDIR" >/dev/null
cd ..
cd ..

if [ "$GENMKFILE_PATH" = "" ] ; then
   if [ -f "./packages/genmkfile/usr/share/genmkfile/makefile-full" ]; then
      GENMKFILE_PATH="./packages/genmkfile/usr/share/genmkfile"
   elif [ -f "./usr/share/genmkfile/makefile-full" ]; then
      GENMKFILE_PATH="./usr/share/genmkfile"
   elif [ -f "/usr/share/genmkfile/makefile-full" ]; then
      GENMKFILE_PATH="/usr/share/genmkfile"
   else
      echo "$0: ERROR: Auto detection of GENMKFILE_PATH failed!"
   fi
fi

GENMKFILE_PATH="$(realpath "$GENMKFILE_PATH")"
export GENMKFILE_PATH

popd >/dev/null

"${GENMKFILE_PATH}/make-helper.bsh" "$@"
